/* TinyTB shield: PMW3610 (SPI) + 4 direct-wired keys */

#include <zephyr/dt-bindings/gpio/gpio.h>

 / {
	compatible = "zmk,shield-tinytb";

	chosen {
		zmk,kscan = &kscan0;
	};

	aliases {
		kscan = &kscan0;
		trackball = &pmw3610;
	};

	/* ---- 4キーのダイレクト入力 ---- */
	kscan0: kscan {
		compatible = "zmk,kscan-gpio-direct";
		label = "TINyTB Keys";

		/* 実配線に合わせたピン割り当て */
		input-gpios = <&gpio0  5 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>,  /* D0 */
			      <&gpio0  4 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>,  /* D1 */
			      <&gpio0 11 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>,  /* D2 */
			      <&gpio1 12 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;  /* D3 */

		debounce-press-ms = <5>;
		debounce-release-ms = <5>;
	};
};

&spi0 {
	status = "okay";

	cs-gpios = <&gpio0 28 GPIO_ACTIVE_LOW>;   /* NCS pin */

	pmw3610: pmw3610@0 {
		compatible = "pixart,pmw3610";
		reg = <0>;                     /* cs-gpios[0] */
		spi-max-frequency = <2000000>;

		irq-gpios = <&gpio0 29 GPIO_ACTIVE_LOW>;  /* MOT pin */
	};
};
